(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{413:function(t,e,v){"use strict";v.r(e);var s=v(17),_=Object(s.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"lotus集群替换为venus集群"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lotus集群替换为venus集群"}},[t._v("#")]),t._v(" Lotus集群替换为Venus集群")]),t._v(" "),v("h2",{attrs:{id:"venus与lotus集群简介"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#venus与lotus集群简介"}},[t._v("#")]),t._v(" Venus与Lotus集群简介")]),t._v(" "),v("p",[t._v("本文档基于"),v("a",{attrs:{href:"https://github.com/filecoin-project/lotus/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lotus"),v("OutboundLink")],1),t._v(" & "),v("a",{attrs:{href:"https://github.com/filecoin-project/venus/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Venus"),v("OutboundLink")],1),t._v("公开版本进行说明。部分内容涉及到矿工对程序的定制化修改，需要有针对性的方案。")]),t._v(" "),v("p",[t._v("Tips:")]),t._v(" "),v("ul",[v("li",[t._v("以下所有"),v("code",[t._v("<>")]),t._v("都是需替换的参数，根据矿工的实际情况替换")]),t._v(" "),v("li",[t._v("具体版本请使用git checkout选择")]),t._v(" "),v("li",[t._v("环境依赖：\n"),v("ul",[v("li",[t._v("golang ^1.15\n"),v("ul",[v("li",[t._v("go env -w GOPROXY=https://goproxy.io,direct")]),t._v(" "),v("li",[t._v("go env -w GO111MODULE=on")])])]),t._v(" "),v("li",[t._v("git")])])])]),t._v(" "),v("h3",{attrs:{id:"venus集群的组件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#venus集群的组件"}},[t._v("#")]),t._v(" venus集群的组件")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("程序")]),t._v(" "),v("th",[t._v("服务器")]),t._v(" "),v("th",[t._v("类型")]),t._v(" "),v("th",[t._v("作用")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("venus-auth")]),t._v(" "),v("td",[t._v("<IP1>")]),t._v(" "),v("td",[t._v("共享")]),t._v(" "),v("td",[t._v("Venus-auth 用于统一授权，当矿工组件访问共享组件的时候需要使用此服务注册生成的token")])]),t._v(" "),v("tr",[v("td",[t._v("venus-wallet")]),t._v(" "),v("td",[t._v("<IP2>")]),t._v(" "),v("td",[t._v("共享")]),t._v(" "),v("td",[t._v("钱包管理，数据签名")])]),t._v(" "),v("tr",[v("td",[t._v("venus")]),t._v(" "),v("td",[t._v("<IP3>")]),t._v(" "),v("td",[t._v("共享")]),t._v(" "),v("td",[t._v("Filecoin节点数据同步")])]),t._v(" "),v("tr",[v("td",[t._v("venus-messager")]),t._v(" "),v("td",[t._v("<IP4>")]),t._v(" "),v("td",[t._v("共享")]),t._v(" "),v("td",[t._v("管理集群中的消息，保证消息上链，控制消息流量，重试等。可对接多个钱包，针对这些钱包做消息管理")])]),t._v(" "),v("tr",[v("td",[t._v("venus-miner")]),t._v(" "),v("td",[t._v("<IP5>")]),t._v(" "),v("td",[t._v("共享")]),t._v(" "),v("td",[t._v("管理多个矿工赢得选票，打包消息，通过访问venus-sealer获取数据证明;签名时调用venus-wallet")])]),t._v(" "),v("tr",[v("td",[t._v("venus-sealer")]),t._v(" "),v("td",[t._v("<IP6>")]),t._v(" "),v("td",[t._v("非共享")]),t._v(" "),v("td",[t._v("sector状态机管理；算力增长调度;算力维持")])]),t._v(" "),v("tr",[v("td",[t._v("venus-worker")]),t._v(" "),v("td",[t._v("<IP7>")]),t._v(" "),v("td",[t._v("非共享")]),t._v(" "),v("td",[t._v("数据封装(P1,P2,C1,C2等阶段任务的执行)")])])])]),t._v(" "),v("h3",{attrs:{id:"lotus集群的组件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lotus集群的组件"}},[t._v("#")]),t._v(" lotus集群的组件")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("程序")]),t._v(" "),v("th",[t._v("服务器")]),t._v(" "),v("th",[t._v("类型")]),t._v(" "),v("th",[t._v("作用")]),t._v(" "),v("th",[t._v("对应venus组件")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("lotus")]),t._v(" "),v("td",[t._v("<IP1>")]),t._v(" "),v("td",[t._v("可共享")]),t._v(" "),v("td",[t._v("Filecoin节点数据同步；消息池；钱包管理，数据签名等")]),t._v(" "),v("td",[t._v("venus，venus-messager部分功能，venus-wallet部分功能")])]),t._v(" "),v("tr",[v("td",[t._v("lotus-miner")]),t._v(" "),v("td",[t._v("<IP2>")]),t._v(" "),v("td",[t._v("非共享")]),t._v(" "),v("td",[t._v("sector状态机管理；算力增长调度；算力维持；赢得选票")]),t._v(" "),v("td",[t._v("venus-miner部分功能，venus-sealer")])]),t._v(" "),v("tr",[v("td",[t._v("lotus-worker")]),t._v(" "),v("td",[t._v("<IP3>")]),t._v(" "),v("td",[t._v("非共享")]),t._v(" "),v("td",[t._v("数据封装(P1,P2,C1,C2等阶段任务执行者)")]),t._v(" "),v("td",[t._v("venus-worker")])])])]),t._v(" "),v("p",[t._v("venus-wallet对钱包做了更加精细化的管理，比如权限管理：用户可以指定钱包能签名的数据类型，管理员可以锁定某个钱包，限制签名等；")]),t._v(" "),v("p",[t._v("venus-message允许消息在将要发送到消息池时再分配nonce值，对于不同的消息可指定优先级，能够较好控制消息的打包节奏；")]),t._v(" "),v("p",[t._v("venus-miner将多个矿工的出块集中到一个组件，而lotus只能负责一个miner的出块。")]),t._v(" "),v("h2",{attrs:{id:"lotus集群替换为venus集群-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lotus集群替换为venus集群-2"}},[t._v("#")]),t._v(" Lotus集群替换为Venus集群")]),t._v(" "),v("h3",{attrs:{id:"_1-替换说明"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-替换说明"}},[t._v("#")]),t._v(" 1.替换说明")]),t._v(" "),v("p",[t._v("Venus在管理多集群时更具优越性，其共享组件可为多个集群服务。如果集群比较少时，不建议搭建一整套共享组件，可以联合多个集群共用一套Venus共享组件以满足服务。")]),t._v(" "),v("h3",{attrs:{id:"_2-替换操作"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-替换操作"}},[t._v("#")]),t._v(" 2.替换操作")]),t._v(" "),v("h4",{attrs:{id:"_1-venus共享组件替换lotus组件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-venus共享组件替换lotus组件"}},[t._v("#")]),t._v(" 1）Venus共享组件替换Lotus组件")]),t._v(" "),v("p",[t._v("Venus服务的共享组件包括："),v("a",{attrs:{href:"https://github.com/filecoin-project/venus",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus"),v("OutboundLink")],1),t._v("、"),v("a",{attrs:{href:"https://github.com/filecoin-project/venus-messager",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-messager"),v("OutboundLink")],1),t._v("、"),v("a",{attrs:{href:"https://github.com/filecoin-project/venus-auth",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-auth"),v("OutboundLink")],1),t._v("、"),v("a",{attrs:{href:"https://github.com/filecoin-project/venus-wallet",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-wallet"),v("OutboundLink")],1),t._v("、"),v("a",{attrs:{href:"https://github.com/filecoin-project/venus-miner",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-miner"),v("OutboundLink")],1),t._v("，部署请参考 "),v("RouterLink",{attrs:{to:"/zh/guide/How-To-Deploy-MingPool.html"}},[t._v("How-To-Deploy-MingPool")]),t._v("。")],1),t._v(" "),v("h4",{attrs:{id:"_2-venus独立组件替换lotus组件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-venus独立组件替换lotus组件"}},[t._v("#")]),t._v(" 2）Venus独立组件替换Lotus组件")]),t._v(" "),v("h5",{attrs:{id:"方案1-公开版lotus-miner组件替换"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#方案1-公开版lotus-miner组件替换"}},[t._v("#")]),t._v(" 方案1: 公开版lotus-miner组件替换")]),t._v(" "),v("ul",[v("li",[t._v("停止产生新的sector封装任务,等待所有进行中的sector任务完成；")]),t._v(" "),v("li",[t._v("用venus-sealer替换lotus-miner后重启服务，venus-sealer的部署请参考 "),v("RouterLink",{attrs:{to:"/zh/guide/How-To-Deploy-MingPool.html"}},[t._v("How-To-Deploy-MingPool")]),t._v("。")],1)]),t._v(" "),v("p",[t._v("替换前Lotus集群流程\n"),v("img",{attrs:{src:"/lotus-cluster-1.png",alt:"lotus-cluster-1"}})]),t._v(" "),v("p",[t._v("替换后Venus集群流程\n"),v("img",{attrs:{src:"/venus-replace-lotus-cluster-1.png",alt:"venus-replace-lotus-cluster-1"}})]),t._v(" "),v("h5",{attrs:{id:"方案2-定制化lotus-miner组件替换"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#方案2-定制化lotus-miner组件替换"}},[t._v("#")]),t._v(" 方案2: 定制化lotus-miner组件替换")]),t._v(" "),v("p",[t._v("因为存在矿工自己修改了lotus-miner代码的情况，如果想继续沿用，需要对lotus-miner做如下调整：")]),t._v(" "),v("ul",[v("li",[t._v("不要启用lotus-poster的winingPoSt程序，这需要改动代码；")]),t._v(" "),v("li",[t._v("已有Sector数据的转换，这需要开发；")]),t._v(" "),v("li",[t._v("lotus-miner对接venus-messager，这需要开发；")]),t._v(" "),v("li",[t._v("矿工可以自己做相关工具的开发，或者等待Venus开发者后续推出相关工具及开发者文档。")])]),t._v(" "),v("p",[t._v("替换前Lotus集群流程\n"),v("img",{attrs:{src:"/lotus-cluster-2.png",alt:"lotus-cluster-2"}})]),t._v(" "),v("p",[t._v("替换后Venus集群流程\n"),v("img",{attrs:{src:"/venus-replace-lotus-cluster-2.png",alt:"venus-replace-lotus-cluster-2"}})])])}),[],!1,null,null,null);e.default=_.exports}}]);