(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{384:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("考虑到庞大的初始硬件和Filecoin质押"),a("a",{attrs:{href:"https://filscan.io/calculator",target:"_blank",rel:"noopener noreferrer"}},[t._v("投资"),a("OutboundLink")],1),t._v("以及相关的运营成本，开始Filecoin挖掘是一项艰巨的任务。 囊括了安全性、易用性和分布式存储池的想法，Venus将帮助存储提供者，正如社区所说，把"),a("a",{attrs:{href:"https://filecoinproject.slack.com/archives/CEGN061C5/p1610810730117900?thread_ts=1610809298.116800&cid=CEGN061C5",target:"_blank",rel:"noopener noreferrer"}},[t._v("全职工作"),a("OutboundLink")],1),t._v("变成为一个严肃的爱好。 希望本教程能让您立即开始挖矿！")]),t._v(" "),a("h2",{attrs:{id:"如何提供存储服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何提供存储服务"}},[t._v("#")]),t._v(" 如何提供存储服务")]),t._v(" "),a("p",[t._v("有两种方法可以开始使用Venus来提供存储服务。")]),t._v(" "),a("ol",[a("li",[t._v("部署最少的硬件并获得对第三方托管的共享venus模块的使用帐号。(请参阅"),a("RouterLink",{attrs:{to:"/zh/guide/Using-venus-Shared-Modules.html"}},[t._v("这个")]),t._v("教程以了解更多信息)")],1),t._v(" "),a("li",[t._v("自行部署所有需要的硬件和venus模块。(本教程的其余部分将引导您完成这种部署Venus服务的方式)")])]),t._v(" "),a("p",[t._v("在遵循其余的教程和成功部署后，您可以开始封装扇区，增加算力并通过您对网络存储容量的贡献最终获得区块奖励！")]),t._v(" "),a("h2",{attrs:{id:"venus模块介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus模块介绍"}},[t._v("#")]),t._v(" venus模块介绍")]),t._v(" "),a("p",[t._v("根据其在挖矿集群中的作用，模块可以大致分为两类：共享和独立。 共享模块可以被认为是开始封装扇区所需的基础。 大多数与区块链的交互，如链同步、发送消息、赢得赢票等，都是由共享模块处理的。 这个想法是许多矿工都可以共用一组共享模块，从而减少维护成本。 独立模块处理封装和证明您的扇区。如果您选择使用第三方托管的共享Venus模块，您将花费大部分时间在独立模块上。 另请注意，"),a("code",[t._v("venus-wallet")]),t._v("模块可以作为共享或独立部署。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("name")]),t._v(" "),a("th",[t._v("role")]),t._v(" "),a("th",[t._v("shared/independent")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("daemon for chain interactions")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-miner",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-miner"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("block winning and proving")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-messager",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-messager"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("chain message management")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-auth",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-auth"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("utility for authorized use of shared modules")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/ipfs-force-community/venus-gateway",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-gateway"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("utility for controlled access point of shared modules")]),t._v(" "),a("td",[t._v("shared")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-wallet",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-wallet"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("addresses/keys management")]),t._v(" "),a("td",[t._v("shared/independent")])]),t._v(" "),a("tr",[a("td",[a("a",{attrs:{href:"https://github.com/filecoin-project/venus-sealer",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-sealer"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://github.com/filecoin-project/venus-sealer",target:"_blank",rel:"noopener noreferrer"}},[t._v("venus-worker"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("job scheduling, sealing and proving")]),t._v(" "),a("td",[t._v("independent")])])])]),t._v(" "),a("h2",{attrs:{id:"服务架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务架构"}},[t._v("#")]),t._v(" 服务架构")]),t._v(" "),a("p",[t._v("下图展示了venus模块如何相互交互。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/venus-cluster.png",alt:"venus-cluster"}})]),t._v(" "),a("h2",{attrs:{id:"硬件要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#硬件要求"}},[t._v("#")]),t._v(" 硬件要求")]),t._v(" "),a("p",[t._v("在"),a("a",{attrs:{href:"https://github.com/filecoin-project/community-china/discussions/18",target:"_blank",rel:"noopener noreferrer"}},[t._v("此处"),a("OutboundLink")],1),t._v("了解有关硬件要求的更多信息。")]),t._v(" "),a("h2",{attrs:{id:"前期准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前期准备"}},[t._v("#")]),t._v(" 前期准备")]),t._v(" "),a("p",[t._v("在深入部署您的挖矿操作之前，请确保您已完成以下步骤。")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("建议您在部署到主网上之前在"),a("code",[t._v("nerpa")]),t._v(" 或"),a("code",[t._v("calibration")]),t._v("网络中测试您的配置。")])]),t._v(" "),a("h3",{attrs:{id:"永久存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#永久存储"}},[t._v("#")]),t._v(" 永久存储")]),t._v(" "),a("p",[t._v("选择您熟悉的网络文件系统（例如 NFS）并部署您的存储集群。")]),t._v(" "),a("h3",{attrs:{id:"软件依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件依赖"}},[t._v("#")]),t._v(" 软件依赖")]),t._v(" "),a("p",[t._v("在运行 venus 之前，您需要安装以下软件。")]),t._v(" "),a("h4",{attrs:{id:"构建工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建工具"}},[t._v("#")]),t._v(" 构建工具")]),t._v(" "),a("p",[t._v("Ubuntu/Debian:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mesa-opencl-icd ocl-icd-opencl-dev gcc "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" bzr jq pkg-config "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" clang build-essential hwloc libhwloc-dev "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -y "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n")])])]),a("p",[t._v("CentOS:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" gcc bzr jq pkgconfig clang llvm mesa-libGL-devel opencl-headers ocl-icd ocl-icd-devel hwloc-devel\n")])])]),a("h4",{attrs:{id:"go"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go"}},[t._v("#")]),t._v(" Go")]),t._v(" "),a("p",[t._v("构建venus，您需要安装"),a("a",{attrs:{href:"https://golang.org/dl/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Go 1.16 或更高版本"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -c https://golang.org/dl/go1.16.2.linux-amd64.tar.gz -O - "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -xz -C /usr/local\n")])])]),a("p",[t._v("将 "),a("code",[t._v("/usr/local/go/bin")]),t._v(" 添加到您的路径并设置"),a("code",[t._v("go env")]),t._v("。对于大多数Linux系统，您可以运行以下内容：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"export PATH='),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(':/usr/local/go/bin"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" ~/.bashrc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# setup go env")]),t._v("\ngo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GOPROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://goproxy.io,direct\ngo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" -w "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GO111MODULE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("on\n")])])]),a("p",[t._v("如果卡住，请参阅"),a("a",{attrs:{href:"https://golang.org/doc/install",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方Golang安装说明"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"安装venus-auth"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装venus-auth"}},[t._v("#")]),t._v(" 安装venus-auth")]),t._v(" "),a("p",[t._v("下载并编译"),a("code",[t._v("venus-auth")]),t._v("的源代码。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-auth.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-auth\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[a("code",[t._v("venus-auth")]),t._v(" 的默认配置文件位于"),a("code",[t._v("~/venus-auth/config.toml")]),t._v("。")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Logs")]),t._v(" "),a("p",[t._v("日志默认打印到控制台。 通过配置可以支持InfluxDB。")])]),t._v(" "),a("h3",{attrs:{id:"使用mysql-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用mysql-可选"}},[t._v("#")]),t._v(" 使用MySQL (可选)")]),t._v(" "),a("p",[t._v("支持MySQL 5.7及以上版本，可替代默认的"),a("code",[t._v("Badger")]),t._v("键值数据库。要使用 MySQL 数据库，请修改配置中的 "),a("code",[t._v("db")]),t._v("部分。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus-auth/config.toml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Data source configuration item")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# support: badger (default), mysql ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# the mysql DDL is in the script package ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql"')]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The following parameters apply to MySQL")]),t._v("\nDSN "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<USER>:<PASSWORD>@(127.0.0.1:3306)/venus_auth?parseTime=true&loc=Local&charset=utf8mb4&collation=utf8mb4_unicode_ci&readTimeout=10s&writeTimeout=10s"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# conns 1500 concurrent")]),t._v("\nmaxOpenConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("\nmaxIdleConns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),t._v("\nmaxLifeTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"120s"')]),t._v("\nmaxIdleTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30s"')]),t._v("\n")])])]),a("p",[t._v("重启"),a("code",[t._v("venus-auth")]),t._v("使配置生效。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" auth\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_AUTH_PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-auth run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" auth.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"生成token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成token"}},[t._v("#")]),t._v(" 生成token")]),t._v(" "),a("p",[a("code",[t._v("venus-auth")]),t._v("管理着其他venus模块使用的"),a("a",{attrs:{href:"https://jwt.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jwt"),a("OutboundLink")],1),t._v("令牌，以便它们在网络上安全地相互通信。")]),t._v(" "),a("p",[t._v("为共享模块生成token。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# --perm specifies admin, sign, wirte or read permission of the token generated")]),t._v("\n$ ./venus-auth token gen --perm admin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("为独立模块生成令牌。 token可以通过"),a("code",[t._v("<USER>")]),t._v(" 逻辑分组，作为加入矿池的单个矿工。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ ./venus-auth usdr "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" --name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ ./venus-auth token gen --perm "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("USER_WRITE_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ ./venus-auth token gen --perm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("USER_READ_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("./venus-auth user add <USER>")]),t._v(" 对不同的token进行逻辑分组。")])]),t._v(" "),a("h2",{attrs:{id:"安装venus-gateway"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装venus-gateway"}},[t._v("#")]),t._v(" 安装venus-gateway")]),t._v(" "),a("p",[t._v("下载并编译"),a("code",[t._v("venus-gateway")]),t._v("的源代码。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/ipfs-force-community/venus-gateway.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-gateway\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ go mod tidy\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("启动"),a("code",[t._v("venus-gateway")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-gateway "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--listen /ip4/0.0.0.0/tcp/45132 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nrun "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Use either a http or https url")]),t._v("\n--auth-url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("https://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus-gateway.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h2",{attrs:{id:"安装venus-daemon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装venus-daemon"}},[t._v("#")]),t._v(" 安装venus daemon")]),t._v(" "),a("p",[t._v("下载并编译"),a("code",[t._v("venus-daemon")]),t._v("的源代码。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" deps\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("启动"),a("code",[t._v("venus")]),t._v("进程进行链同步。 使用 "),a("code",[t._v("--network")]),t._v(" 来指定"),a("code",[t._v("venus")]),t._v("连接的网络。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" \n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("tail -f venus.log")]),t._v("检查同步过程中是否有任何错误。")])]),t._v(" "),a("h3",{attrs:{id:"允许访问venus-daemon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#允许访问venus-daemon"}},[t._v("#")]),t._v(" 允许访问venus daemon")]),t._v(" "),a("p",[t._v("默认情况下，"),a("code",[t._v("venus")]),t._v("进程只响应本地访问。更改以下配置以允许从其他地址访问。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ~/.venus/config.json\n")])])]),a("p",[t._v("将"),a("code",[t._v("apiAddress")]),t._v("从"),a("code",[t._v("/ip4/127.0.0.1/tcp/3453")]),t._v("更改为"),a("code",[t._v("/ip4/0.0.0.0/tcp/3453")]),t._v("。保存并关闭配置文件。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"api"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"apiAddress"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/ip4/0.0.0.0/tcp/3453"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("重启"),a("code",[t._v("venus")]),t._v("进程使配置生效。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" venus\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_PID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus daemon --network nerpa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" venus.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" \n")])])]),a("h2",{attrs:{id:"安装venus-messager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装venus-messager"}},[t._v("#")]),t._v(" 安装venus-messager")]),t._v(" "),a("p",[t._v("下载并编译"),a("code",[t._v("venus-messager")]),t._v("的源代码。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-messager.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-messager\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" \n")])])]),a("p",[t._v("启动"),a("code",[t._v("venus-messager")]),t._v("。请注意，"),a("code",[t._v("--auth-url")]),t._v("、"),a("code",[t._v("--node-url")]),t._v(" 和"),a("code",[t._v("--auth-token")]),t._v(" 是为了让 venus-messager 了解其他"),a("code",[t._v("venus")]),t._v("模块的存在并进行自身的身份验证。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-messager run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--node-url /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_DAEMON_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IP_ADDRESS_OF_VENUS_GATEWAY"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/45132 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--auth-token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--db-type mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--mysql-dsn "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<USER>:<PASSWORD>@(127.0.0.1:3306)/venus_messager?parseTime=true&loc=Local&readTimeout=10s&writeTimeout=10s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" msg.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("如果没有指定与数据库相关的参数，"),a("code",[t._v("venus-messager")]),t._v("将默认使用 sqlite。")])]),t._v(" "),a("h2",{attrs:{id:"安装venus-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装venus-miner"}},[t._v("#")]),t._v(" 安装venus-miner")]),t._v(" "),a("p",[t._v("下载并编译"),a("code",[t._v("venus-miner")]),t._v("的源代码。")]),t._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/filecoin-project/venus-miner.git\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" venus-miner\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RELEASE_TAG"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v("\n")])])]),a("p",[t._v("初始化"),a("code",[t._v("venus-miner")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner init\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# For nettype, choose from mainnet, nerpanet, debug, 2k, calibnet")]),t._v("\n--nettype nerpanet\n--auth-api "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("http://VENUS_AUTH_IP_ADDRESS:PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("SHARED_ADMIN_AUTH_TOKEN"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--gateway-api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_GATEWAY_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/45132\n--api /ip4/"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VENUS_DAEMON_IP_ADDRESS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/tcp/3453 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n")])])]),a("p",[t._v("启动"),a("code",[t._v("venus-miner")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./venus-miner run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v("miner.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("h3",{attrs:{id:"矿工管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#矿工管理"}},[t._v("#")]),t._v(" 矿工管理")]),t._v(" "),a("p",[t._v("一旦有用户(有"),a("code",[t._v("miner id")]),t._v("的"),a("code",[t._v("venus-sealer")]),t._v(") 连接到您的共享模块。 您可以通过以下方式查询该"),a("code",[t._v("miner id")]),t._v("的状态。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address state \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Addr"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<MINER_ID>"')]),t._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IsMining"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Err"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" null\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("如果你的矿工的"),a("code",[t._v("IsMining")]),t._v("为"),a("code",[t._v("false")]),t._v("，你可以运行以下命令来启动这个"),a("code",[t._v("miner id")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("MINER_ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("列出所有已连接到"),a("code",[t._v("venus-miner")]),t._v("的"),a("code",[t._v("miner id")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ ./venus-miner address list\n")])])]),a("h2",{attrs:{id:"下一步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下一步"}},[t._v("#")]),t._v(" 下一步")]),t._v(" "),a("p",[t._v("接下来请按照这个"),a("RouterLink",{attrs:{to:"/zh/guide/Using-venus-Shared-Modules.html"}},[t._v("文档")]),t._v("加入到你刚刚部署的存储池！")],1),t._v(" "),a("h2",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题?")]),t._v(" "),a("p",[t._v("来"),a("a",{attrs:{href:"https://filecoinproject.slack.com/archives/CEHHJNJS3",target:"_blank",rel:"noopener noreferrer"}},[t._v("Slack"),a("OutboundLink")],1),t._v("上找我们吧！")])])}),[],!1,null,null,null);s.default=n.exports}}]);