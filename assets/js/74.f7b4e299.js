(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{412:function(s,e,a){"use strict";a.r(e);var t=a(17),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"venus-分布式矿池常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-分布式矿池常见问题"}},[s._v("#")]),s._v(" venus 分布式矿池常见问题")]),s._v(" "),a("h2",{attrs:{id:"venus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus"}},[s._v("#")]),s._v(" venus")]),s._v(" "),a("h3",{attrs:{id:"worker-fil-不足未及时处理或venus节点出口流量被打满-大量任务卡在waitseed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#worker-fil-不足未及时处理或venus节点出口流量被打满-大量任务卡在waitseed"}},[s._v("#")]),s._v(" worker fil 不足未及时处理或venus节点出口流量被打满，大量任务卡在WaitSeed")]),s._v(" "),a("p",[s._v("   在venus-auth节点上使用"),a("code",[s._v("./venus-messager msg list-fail")]),s._v("命令打开失败的消息，然后使用"),a("code",[s._v("./venus-messager msg mark-bad --really-do-it <失败消息id>")]),s._v("命令将失败的消息打回sealer侧重启判断消息是否有问题；再次检查是否还有失败的消息")]),s._v(" "),a("h3",{attrs:{id:"venus节点宕机或磁盘空间将满-切换备机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus节点宕机或磁盘空间将满-切换备机"}},[s._v("#")]),s._v(" venus节点宕机或磁盘空间将满，切换备机")]),s._v(" "),a("p",[s._v("venus-message: 修改用户家目录下的messager.toml配置文件里的内容,指向新节点后，重启venus-message服务")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cat ~/messager.toml\n[node]\n    url = "/ip4/192.168.1.134/tcp/3453"\n    token= "eyJhbGciOIUacbciIsInR5cCI6I.iLCJwZXJtIjoic2lnbiIs.c65GtR7IVjJYE"\n')])])]),a("p",[s._v("kill掉之前的venus-messager进程后，再重新启动即可")]),s._v(" "),a("p",[s._v("venus-miner: 修改用户家目录下的配置文件，连接的ip地址")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cat ~/.venusminer/config.toml\nListenAPI = "/ip4/192.168.0.98/tcp/3453/http"\nToken = "eyJhbGciOiJIUzIsInR5c.eyJuYW1lIjoibWMmV4dCI6IiJ9.3P0x6StVjJYEhv198"\n')])])]),a("p",[s._v("重新启动venus-miner服务")]),s._v(" "),a("p",[s._v("winning-post和sealer节点修改.lotus/api和.lotus/token值")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cat .venus/api\n/ip4/120.78.159.125/tcp/3453/http\n")])])]),a("p",[s._v("修改完成后使用重启winning-post和sealer")]),s._v(" "),a("h2",{attrs:{id:"venus-messager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-messager"}},[s._v("#")]),s._v(" venus-messager")]),s._v(" "),a("h3",{attrs:{id:"venus-messager-中大量消息卡住"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-messager-中大量消息卡住"}},[s._v("#")]),s._v(" venus-messager 中大量消息卡住")]),s._v(" "),a("p",[s._v("   默认每个worker地址30秒只往链上发送的消息数最多只有20条，可以根据实际体量进行稍微增加到30条（值越大同一高度往链上发送的消息数就越多，可能造成小部分的SysErrOutOfGas消息）")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("./venus-messager address set-sel-msg-num --num "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("worker 地址"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("h3",{attrs:{id:"venus-message消息签名失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-message消息签名失败"}},[s._v("#")]),s._v(" "),a("span",{attrs:{id:"signed-failed"}},[s._v("venus-message消息签名失败")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ERROR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-12T16:37:45+8:00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" wallet sign failed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65735211")]),s._v("-9b4f-447q-9c8f-ad23791c75e fail **could not decrypt key with given password**\n")])])]),a("p",[s._v("从日志中发现消息在签名时失败，主要是wallet设置了错误的钱包密码。")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ERROR wallet sign failed 7edd68a5-4a6f-42c1-bded-acfd7d320118 **fail no connect found "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" account sealer** and from "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),a("p",[s._v("主要是wallet没有支持"),a("code",[s._v("sealer")]),s._v("这个账户，"),a("a",{attrs:{href:"https://github.com/filecoin-project/venus-sealer/issues/63#issuecomment-880363242",target:"_blank",rel:"noopener noreferrer"}},[s._v("解决方案"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"venus-miner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-miner"}},[s._v("#")]),s._v(" venus-miner")]),s._v(" "),a("h2",{attrs:{id:"venus-miner无法出块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-miner无法出块"}},[s._v("#")]),s._v(" venus-miner无法出块")]),s._v(" "),a("ul",[a("li",[s._v("确认venus-miner连接的venus节点同步高度正常，并检查其日志是否正常；")]),s._v(" "),a("li",[s._v("在venus-miner节点上logs/venus-miner.log日志信息；使用 ./venus-miner address state 命令确认IsMining为true")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ ./venus-miner address state\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Addr"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f0xxx"')]),s._v(",     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 矿工号")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IsMining"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否在挖矿（出块）")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Err"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否有报错信息")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("h2",{attrs:{id:"venus-wallet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-wallet"}},[s._v("#")]),s._v(" venus-wallet")]),s._v(" "),a("h3",{attrs:{id:"venus-wallet启动之后报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-wallet启动之后报错"}},[s._v("#")]),s._v(" venus-wallet启动之后报错")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('ERROR\twallet_event\twallet_event/listenevent.go:192 WalletSign error password not set {"api hub": "/ip4/<IP_ADDRESS>/tcp/45132"}\n')])])]),a("p",[s._v("是由于没有执行./venus-wallet set-password命令设置密码导致的，每次venus-wallet重启都需要执行设置密码的操作，也可以在启动时设置密码："),a("code",[s._v("./venus-wallet run --password=<password>")]),s._v("\n设置密码后，如果有下列报错，则需要检查配置文件。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ERROR\twallet_event\twallet_listen/listenevent.go:120 listen wallet event errored: listenWalletRequestOnce listenWalletRequestOnce call failed: handler: websocket connection closed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api hub"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/ip4/47.251.6.27/tcp/45132"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("直到到connect to server返回正确的消息为止。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("INFO\twallet_event\twallet_event/listenevent.go:156 connect to server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65735211")]),s._v("-9b4f-447q-9c8f-ad23791c75e "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api hub"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/ip4/47.251.6.27/tcp/45132"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"venus-sealer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-sealer"}},[s._v("#")]),s._v(" venus-sealer")]),s._v(" "),a("h3",{attrs:{id:"venus-sealer-创建矿工失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#venus-sealer-创建矿工失败"}},[s._v("#")]),s._v(" venus-sealer 创建矿工失败")]),s._v(" "),a("ol",[a("li",[s._v("检查 sealer的日志是否有异常")])]),s._v(" "),a("blockquote",[a("p",[s._v("日志中会输出创建矿工的消息：Pushed CreateMiner message: 556f3c3b-35cb-40e5-b096-924e33920420")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("查看消息是否推送到messager")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('./venus-messager msg search --id="9965e5ea-8142-4b61-8312-425d5598092e"\n\n{\n        "ID": "9965e5ea-8142-4b61-8312-425d5598092e",\n        "SignedCid": null,\n        "from": "t3wjbqsk5wvm7troa72xnnzjvxuspvtdemdcetrml3rmq3h4lghhqw5ys42vymitoanacinmkaf5pwf2kfclsa",\n        "Height": 0,\n        "Receipt": {\n                "ExitCode": -1,\n                "ReturnValue": "",\n                "GasUsed": 0\n        },\n        "State": "UnFillMsg",\n }\n')])])]),a("p",[s._v(":::info\n消息各个状态代表的含义：\nUnFillMsg：未签名消息\nFillMsg：已签名消息\nOnChainMsg：已上链消息\nFailedMsg：由于各种原因失败的消息\n:::")]),s._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[s._v("消息已推送到messager，检查消息状态，初始状态是 "),a("code",[s._v("UnFillMsg")])])]),s._v(" "),a("ul",[a("li",[s._v("若消息长时间是"),a("code",[s._v("UnFillMsg")]),s._v("状态，查看日志，可能是gas预估失败或者"),a("a",{attrs:{href:"#signed-failed"}},[s._v("签名失败")])]),s._v(" "),a("li",[s._v("若消息状态是"),a("code",[s._v("FillMsg")]),s._v("，但长时间未上链，先查看messager日志，再检查是否已推送到节点消息池："),a("code",[s._v("./venus mpool pending --from <address>")]),s._v("，若不在消息池，查看节点日志")]),s._v(" "),a("li",[s._v("若消息状态是"),a("code",[s._v("FailedMsg")]),s._v("，查看失败原因："),a("code",[s._v("./venus-messager msg list-fail --from <address>")])])]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("消息未推送到messager，sealer日志会有错误提示")])])])}),[],!1,null,null,null);e.default=n.exports}}]);